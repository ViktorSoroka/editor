!function(t){"use strict";var e,n;t.fn.editorCustom=function(){e=t("<iframe>",{id:"editor",text:"Your browser does`t support iframes"}).appendTo(this),setTimeout(function(){function i(t){return d.getElementById(t)}function o(t,e,n){this.applier=rangy.createClassApplier(e,{elementTagName:n,ignoreWhiteSpace:!1}),this.btn=i(t)}var d=e[0].contentDocument?e[0].contentDocument:e[0].contentDocument?e[0].contentWindow.document:e[0].document,r=e[0].contentWindow||e[0].contentDocument.defaultView,s=d.createDocumentFragment();t("<link>",{rel:"stylesheet",href:'editor/css/iframe-style.min.css?t=<?= time(); ?>"'}).appendTo(t(d).find("head")),t("<script>",{src:"editor/js/uncompressed/libs/lib.min.js"}).appendTo(t(d).find("head")),t("<input>",{type:"button",id:"toggleBold",value:"B"}).appendTo(s),t("<input>",{type:"button",id:"toggleUnderline",value:"U"}).appendTo(s),t("<input>",{type:"button",id:"toggleItalic",value:"I"}).appendTo(s),t("<input>",{type:"button",id:"toggleDelete",value:"Del"}).appendTo(s),d.body.appendChild(s),t("<div>",{contenteditable:"true",id:"edit"}).appendTo(t(d).find("body")),n=function(){var e=["height="+screen.height,"width="+screen.width,"top=0","left=0","resizable=yes","scrollbars=yes","toolbar=yes","menubar=yes","location=yes"].join(","),n=window.open("","myEditor",e);return t(n.document.body).ready(function(){var e=t(d).find("#edit").html();n.document.write('<html><head><title>Preview</title><link rel="stylesheet" type="text/css" href="editor/css/preview.min.css?t=<?= time(); ?>"></head><body>'),t(n.document.body).html(e),n.document.write("</body></html>")}),n.document.close(),window.focus&&n.focus(),!1},o.prototype={toggleStyle:function(){this.applier.toggleSelection(r)},attachEvents:function(){var e=this;t(d).on("empty",function(){(""===t(i("edit")).html()||/^((<(b|i|del|u)\sclass=".{1,4}"><br><\/\3>)|<br>)$/.test(t(i("edit")).html()))&&(t(i("edit")).empty(),e.applier.undoToSelection(r))}),t(d).on("keyup",function(e){var n=e.which||e.keyCode||e.charCode;/^(<(strong|strike|em|ins|u)(.+)?>.+<\/\2>)$/.test(t(i("edit")).html())&&t(i("edit")).html(t(i("edit")).text()),(8===n||46===n)&&(t.trim(t(i("edit")).html()),t(d).trigger("empty"))}),this.btn.ontouchstart=this.btn.onmousedown=function(){this.toggleStyle()}.bind(this)}},rangy.init();var l=rangy.modules.ClassApplier;return rangy.supported&&l&&l.supported&&(new o("toggleBold","bold","b").attachEvents(),new o("toggleUnderline","und","b").attachEvents(),new o("toggleItalic","ita","i").attachEvents(),new o("toggleDelete","del","del").attachEvents()),t(".preview").on("click",function(){n()}),this},100)}}(jQuery);