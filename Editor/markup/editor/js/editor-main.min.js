!function(e){"use strict";e.editorCustomdef=new jQuery.Deferred,e.fn.editorCustom=function(){var t;return function(){var n,o,i;if(t)throw Error("There is can be only one instance of editor");t=this,i=function(t,n,o){var i=e("<"+t+">");if("object"!=typeof n)throw Error("*"+0/0*n);null!=o&&e(i).text(o);for(var r in n)n.hasOwnProperty(r)&&i.attr(r,n[r]);return i},n=i("iframe",{id:"editor",text:"Your browser does`t support iframes"}).appendTo(this),setTimeout(function(){function r(e,t,n){this.applier=rangy.createClassApplier(t,{elementTagName:n,ignoreWhiteSpace:!1}),this.btn=u(e)}var d,s,u,c=n[0].contentDocument?n[0].contentDocument:n[0].contentDocument?n[0].contentWindow.document:n[0].document,a=n[0].contentWindow||n[0].contentDocument.defaultView,l=c.createDocumentFragment(),p=e(c).find("head"),m=e(c).find("body");u=function(e){return c.getElementById(e)},i("link",{rel:"stylesheet",href:window.location.origin+"/Editor/markup/editor/css/iframe-style.min.css?modified=20012009"}).appendTo(p),i("script",{src:window.location.origin+"/Editor/markup/editor/js/uncompressed/libs/lib.min.js"}).appendTo(p),i("input",{type:"button",id:"toggleBold",value:"b"}).appendTo(l),i("input",{type:"button",id:"toggleUnderline",value:"u"}).appendTo(l),i("input",{type:"button",id:"toggleItalic",value:"i"}).appendTo(l),i("input",{type:"button",id:"toggleDelete",value:"del"}).appendTo(l),m.append(l),i("div",{contenteditable:"true",id:"edit"}).appendTo(m),i("button",{"class":"preview"},"preview").appendTo(m),d=e(u("edit")),o=function(){var t=["height="+screen.height,"width="+screen.width,"top=0","left=0","resizable=yes","scrollbars=yes","toolbar=yes","menubar=yes","location=yes"].join(","),n=window.open("","myEditor",t);return e(n.document.body).ready(function(){s=d.html(),n.document.write('<html><head><title>Preview</title><link rel="stylesheet" type="text/css" href="'+window.location.origin+'/Editor/markup/editor/css/preview.min.css?modified=20012009"></head><body>'),e(n.document.body).html(s),n.document.write("</body></html>")}),n.document.close(),window.focus&&n.focus(),!1},r.prototype={toggleStyle:function(){this.applier.toggleSelection(a)},attachEvents:function(){var t=this;e(c).on("empty",function(){s=d.html(),(""===s||/^((<(b|i|del|u)\sclass=".{1,4}"><br><\/\3>)|<br>)$/.test(s))&&(d.empty(),t.applier.undoToSelection(a))}),e(c).on("keyup",function(t){var n=t.which||t.keyCode||t.charCode;/^(<(strong|strike|em|ins|u)(.+)?>.+<\/\2>)$/.test(s)&&d.html(s),(8===n||46===n)&&(e.trim(s),e(c).trigger("empty"))}),this.btn.ontouchstart=this.btn.onmousedown=function(){this.toggleStyle()}.bind(this)}},rangy.init();var h=rangy.modules.ClassApplier;return rangy.supported&&h&&h.supported&&(new r("toggleBold","custom-b","b").attachEvents(),new r("toggleUnderline","custom-u","u").attachEvents(),new r("toggleItalic","custom-i","i").attachEvents(),new r("toggleDelete","custom-del","del").attachEvents()),e(c).find(".preview").on("click",function(){o()}),e.editorCustomdef.resolve(),t},100)}}()}(jQuery);